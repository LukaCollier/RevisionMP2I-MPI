type cnf = int * (int * int) list
(* (n, clauses) | neg (i) = 2 * n - 1 - i *)
type graph = int list array

let example : cnf = (3,[(0,1);(1,2);(4,0);(3,5)])

let examplebis : cnf = (3,[(0,1);(1,2);(4,0);(3,5);(4,5)])

let target = (1000, [(685, 1344); (1641, 182); (1500, 439); (1020, 104); (370, 1921); (885, 1217); (678, 1949); (412, 1615); (606, 401); (869, 1428); (393, 1289); (1423, 14); (544, 1723); (803, 96); (1570, 500); (1212, 1649); (211, 755); (1197, 357); (460, 1897); (1763, 183); (1599, 720); (1970, 559); (1243, 884); (1546, 1220); (1518, 954); (1358, 988); (1051, 424); (1069, 309); (286, 1376); (1122, 438); (1952, 1265); (683, 419); (1740, 782); (1835, 270); (1791, 1136); (1324, 168); (156, 222); (328, 835); (1233, 1636); (671, 1153); (1095, 69); (1092, 357); (146, 824); (133, 278); (989, 688); (1158, 295); (601, 393); (1513, 456); (1013, 1329); (17, 0); (1571, 1186); (1348, 1024); (11, 1836); (232, 1671); (1649, 465); (1450, 1931); (958, 1569); (283, 212); (696, 101); (1461, 809); (729, 721); (1697, 1181); (776, 383); (1731, 830); (1039, 1154); (814, 524); (167, 789); (1887, 168); (26, 1299); (1476, 1321); (395, 1793); (263, 1768); (673, 1962); (677, 1636); (1423, 1298); (211, 1140); (1376, 1738); (1570, 1920); (37, 355); (990, 1088); (207, 1210); (1443, 1051); (95, 4); (1061, 1493); (1532, 1157); (1892, 1753); (731, 1082); (853, 1883); (965, 1407); (1845, 360); (117, 366); (1054, 1951); (445, 400); (1313, 566); (1260, 367); (518, 1031); (542, 383); (1811, 929); (1268, 487); (1106, 1347); (1570, 207); (546, 569); (1022, 129); (1136, 1251); (441, 356); (890, 1425); (1207, 152); (1610, 54); (1802, 838); (380, 938); (718, 1514); (1540, 1580); (866, 91); (1720, 1891); (1396, 1997); (1605, 153); (1124, 542); (687, 388); (1173, 1136); (963, 188); (0, 904); (515, 404); (1264, 616); (1236, 320); (1886, 334); (188, 391); (1130, 12); (454, 846); (655, 438); (327, 460); (1404, 432); (1067, 938); (1979, 1569); (1462, 1572); (411, 566); (1927, 760); (1347, 1971); (301, 1061); (95, 1982); (613, 969); (294, 941); (156, 1925); (992, 534); (1140, 254); (1014, 1787); (1737, 1178); (1285, 772); (671, 197); (162, 186); (1377, 1959); (1271, 1681); (288, 1189); (1446, 1384); (180, 485); (1805, 1242); (1359, 1051); (384, 947); (1168, 651); (1351, 567); (1368, 198); (921, 981); (1318, 1207); (965, 1712); (165, 598); (1019, 1525); (1658, 1680); (330, 1363); (317, 1082); (389, 1755); (1945, 344); (1467, 962); (724, 671); (1834, 1571); (1348, 1101); (397, 646); (1326, 36); (1363, 1085); (1590, 876); (1781, 420); (1081, 656); (162, 636); (769, 16); (286, 149); (865, 1823); (1154, 946); (1528, 1277); (874, 817); (546, 258); (471, 754); (561, 831); (633, 1563); (623, 1655); (566, 538); (1788, 1403); (1905, 289); (572, 1378); (370, 746); (1299, 712); (493, 1747); (514, 1788); (369, 1182); (1467, 887); (495, 1431); (1836, 37); (1704, 1826); (1979, 134); (478, 577); (1170, 1881); (1420, 918); (633, 557); (1359, 181); (1859, 1420); (1990, 1707); (753, 825); (211, 1538); (1955, 1265); (1885, 834); (990, 209); (1698, 1316); (528, 604); (1695, 254); (870, 1927); (1251, 385); (1659, 1742); (1444, 1989); (96, 1938); (1400, 1837); (890, 575); (1911, 370); (969, 369); (1487, 691); (862, 1974); (366, 1587); (63, 953); (662, 177); (1346, 1899); (468, 1310); (569, 1678); (1323, 776); (1697, 1524); (915, 1416); (1549, 857); (41, 1613); (1395, 1045); (580, 1798); (187, 1947); (760, 1206); (1987, 1553); (880, 224); (566, 1096); (1794, 1909); (1304, 987); (1628, 1912); (795, 671); (266, 725); (1957, 579); (1227, 808); (290, 519); (998, 1521); (1576, 415); (1055, 1092); (1548, 244); (1448, 1423); (1535, 1334); (775, 1509); (867, 1329); (707, 1107); (1522, 1198); (1702, 547); (329, 343); (1799, 310); (795, 1541); (459, 1805); (891, 651); (1974, 1956); (1327, 1572); (1346, 141); (1530, 310); (510, 1247); (1582, 824); (183, 392); (1836, 1665); (1978, 975); (1553, 1465); (858, 943); (1843, 790); (1950, 822); (893, 377); (904, 1677); (1531, 419); (1098, 1440); (1655, 849); (1652, 114); (539, 401); (190, 1233); (1130, 1108); (2, 1880); (1468, 360); (1004, 1776); (900, 337); (1440, 1298); (961, 901); (139, 1928); (1811, 380); (889, 261); (839, 1047); (1831, 1604); (670, 1238); (252, 19); (362, 523); (562, 160); (974, 691); (1306, 850); (796, 1296); (876, 1119); (974, 1973); (1347, 515); (1543, 484); (1432, 1240); (569, 1663); (1617, 740); (825, 1546); (519, 191); (1898, 1805); (868, 238); (1945, 1831); (1192, 1716); (318, 1892); (197, 768); (1233, 1767); (341, 1007); (802, 973); (1693, 410); (855, 550); (1065, 1460); (760, 1230); (73, 1866); (365, 1353); (506, 1078); (1254, 1041); (1327, 176); (1000, 737); (46, 66); (1282, 1439); (414, 1746); (246, 942); (629, 1943); (1155, 1530); (96, 1512); (1650, 1837); (1194, 1582); (290, 821); (1189, 954); (965, 462); (928, 1876); (1117, 1725); (681, 1547); (1059, 239); (581, 583); (328, 256); (1506, 90); (1400, 1299); (909, 1698); (1565, 112); (1360, 173); (855, 31); (1861, 1855); (1334, 1704); (1403, 512); (1950, 148); (1316, 1141); (1493, 602); (1181, 1093); (520, 1499); (1956, 1227); (1774, 1473); (1322, 1764); (1274, 1052); (936, 97); (1277, 52); (485, 560); (1733, 1989); (1423, 994); (245, 634); (374, 77); (1717, 1202); (1029, 1893); (1347, 1825); (997, 669); (1088, 1915); (1745, 858); (1919, 1332); (1268, 686); (115, 299); (1762, 979); (1242, 765); (139, 67); (143, 1674); (1420, 741); (1176, 1928); (688, 1542); (1096, 234); (1471, 995); (605, 1121); (1129, 478); (1154, 548); (1385, 870); (1448, 1355); (290, 1918); (1985, 1853); (1415, 1168); (159, 1686); (874, 497); (631, 41); (1922, 429); (360, 697); (301, 1866); (15, 375); (457, 1405); (1172, 673); (851, 406); (1861, 1270); (112, 1155); (1989, 887); (1709, 433); (102, 316); (1598, 1003); (236, 1526); (432, 1730); (1626, 1918); (1820, 1542); (342, 1137); (929, 1599); (280, 1329); (23, 1840); (317, 814); (1312, 1144); (524, 46); (575, 1695); (1094, 303); (361, 772); (1404, 930); (222, 1708); (1599, 785); (470, 715); (940, 1828); (1810, 275); (18, 1685); (591, 1937); (1157, 343); (1709, 332); (1762, 488); (527, 1183); (698, 631); (1810, 351); (664, 1348); (999, 794); (1245, 1181); (1921, 38); (313, 123); (1160, 1573); (320, 1404); (488, 1836); (1235, 485); (548, 94); (14, 1873); (787, 470); (1939, 856); (1746, 871); (229, 283); (322, 186); (1702, 409); (1170, 1475); (502, 347); (1803, 1729); (1493, 493); (1760, 1898); (170, 1670); (1146, 352); (1275, 999); (698, 1075); (976, 709); (191, 766); (1823, 609); (1647, 741); (391, 1460); (524, 226); (1056, 199); (1746, 528); (1732, 838); (1133, 454); (157, 909); (1547, 482); (826, 347); (1862, 1916); (1928, 1404); (1157, 447); (936, 1205); (1022, 511); (225, 1531); (1811, 823); (116, 895); (681, 321); (446, 751); (680, 1712); (815, 1916); (1922, 277); (1558, 1425); (1075, 243); (673, 1803); (37, 235); (1197, 1746); (683, 800); (933, 1508); (1727, 1711); (1352, 1481); (1895, 1744); (776, 1851); (1658, 1810); (199, 602); (262, 219); (180, 1806); (830, 1953); (681, 1672); (1010, 416); (925, 1796); (1446, 1208); (1624, 1592); (586, 656); (201, 1057); (390, 602); (1469, 1987); (1924, 577); (84, 1757); (187, 1748); (467, 1761); (1594, 1538); (377, 1027); (1621, 1066); (1229, 33); (1478, 1888); (1085, 49); (1266, 1331); (406, 1168); (1073, 473); (399, 1134); (608, 24); (961, 1858); (1563, 197); (1892, 435); (1616, 999); (1962, 1343); (1025, 773); (472, 1286); (1641, 1069); (555, 1010); (1097, 64); (1938, 1292); (1157, 1653); (1251, 63); (883, 998); (1964, 650); (1824, 963); (1929, 1414); (1661, 1341); (232, 272); (1386, 1235); (851, 1346); (1337, 504); (399, 1556); (367, 906); (513, 1151); (425, 349); (1835, 484); (1923, 1970); (1219, 217); (1283, 437); (128, 1858); (921, 1446); (97, 45); (1571, 882); (459, 706); (547, 1213); (569, 1412); (847, 587); (742, 339); (1208, 1504); (1341, 1928); (1146, 1320); (936, 1790); (1793, 1753); (1777, 1322); (137, 1100); (692, 366); (1587, 501); (1375, 948); (258, 1073); (305, 836); (726, 914); (935, 1284); (1002, 1265); (1635, 569); (330, 1318); (1944, 761); (1841, 623); (1380, 1064); (1354, 884); (1990, 35); (1081, 1911); (1697, 1149); (563, 135); (1817, 109); (1379, 1094); (439, 1055); (1387, 1921); (784, 273); (514, 303); (1088, 562); (77, 290); (1893, 1887); (1424, 129); (1385, 66); (995, 940); (1147, 1512); (185, 1352); (1057, 162); (1555, 1298); (524, 764); (1784, 381); (1239, 251); (1215, 1707); (937, 725); (1810, 362); (1177, 469); (1928, 1614); (18, 1897); (1394, 697); (1258, 1100); (1808, 1743); (647, 956); (1193, 1759); (1423, 1691); (1209, 941); (684, 1323); (984, 306); (1996, 523); (784, 1271); (492, 830); (707, 1441); (703, 566); (1601, 1125); (206, 1337); (1260, 1777); (1241, 333); (1901, 1364); (330, 1363); (1946, 1145); (637, 857); (244, 420); (829, 1819); (1182, 813); (1077, 1178); (921, 710); (311, 676); (1856, 302); (854, 1964); (306, 1414); (1524, 1007); (193, 638); (297, 643); (871, 1264); (1435, 996); (1538, 934); (1890, 800); (803, 1029); (452, 1333); (1927, 1871); (1839, 1766); (19, 523); (92, 505); (448, 1125); (783, 277); (371, 368); (1787, 1852); (1661, 159); (1850, 1122); (987, 1311); (1932, 266); (1965, 712); (1899, 1153); (191, 1715); (337, 758); (1887, 1785); (1946, 859); (1509, 524); (1919, 1780); (916, 648); (1645, 1243); (1049, 1235); (1293, 1417); (1926, 1204); (538, 1908); (1756, 1787); (764, 578); (943, 1890); (234, 1918); (1457, 229); (1079, 577); (1135, 349); (906, 883); (1814, 61); (986, 1890); (371, 742); (542, 1667); (1878, 38); (90, 1381); (1063, 44); (1514, 431); (1315, 1941); (1854, 1106); (938, 992); (913, 374); (381, 1156); (1164, 983); (122, 217); (1278, 699); (1302, 1047); (135, 469); (1571, 475); (1992, 1078); (1961, 1625); (136, 847); (340, 155); (371, 1933); (1687, 958); (1489, 933); (1269, 48); (1216, 1973); (881, 350); (1140, 347); (550, 687); (1279, 7); (1859, 1177); (512, 224); (1668, 627); (1721, 1492); (1938, 1446); (1156, 1989); (486, 1276); (114, 1293); (1932, 247); (462, 665); (822, 1543); (1574, 474); (820, 340); (1166, 1273); (1283, 132); (998, 1263); (1058, 11); (780, 655); (1617, 172); (397, 76); (923, 1811); (1495, 651); (1452, 1775); (785, 1331); (1178, 1013); (391, 1598); (662, 1371); (1671, 839); (1503, 872); (954, 1868); (954, 962); (1441, 710); (830, 1198); (1598, 116); (1549, 103); (215, 696); (1470, 1018); (1505, 147); (2, 271); (1358, 355); (876, 1980); (1520, 1537); (288, 1948); (874, 672); (501, 720); (1133, 1710); (972, 760); (1173, 1989); (781, 1747); (58, 1291); (32, 999); (40, 1005); (1900, 652); (1633, 1892); (1208, 665); (1025, 1213); (1407, 542); (895, 652); (1550, 1260); (1935, 517); (1998, 1332); (847, 901); (688, 679); (763, 1381); (1449, 416); (1435, 1581); (1365, 35); (787, 1551); (1597, 959); (612, 1323); (1909, 1681); (1262, 62); (508, 108); (201, 211); (699, 717); (1264, 1106); (191, 761); (1874, 1078); (375, 910); (1086, 977); (1664, 1345); (702, 1056); (766, 731); (1490, 1819); (1976, 1185); (1092, 1658); (562, 1652); (1641, 1387); (1112, 505); (1403, 1027); (669, 1410); (1181, 10); (808, 1638); (954, 1301); (521, 1909); (300, 60); (548, 1426); (593, 1324); (1881, 877); (1312, 738); (1851, 484); (365, 1296); (518, 1264); (1276, 914); (103, 1302); (493, 1282); (987, 1239); (1144, 422); (562, 462); (791, 1814); (1864, 1277); (621, 1983); (1157, 540); (540, 1683); (301, 601); (990, 1124); (521, 1126); (878, 1763); (1107, 1360); (1132, 639); (765, 1089); (1140, 1468); (478, 1689); (1890, 1459); (1286, 1114); (150, 1384); (892, 1942); (1184, 139); (990, 995); (64, 1070); (200, 809); (408, 415); (1236, 819); (594, 1373); (1218, 275); (1560, 279); (1277, 1334); (952, 89); (1609, 529); (1835, 670); (1068, 443); (534, 882); (1267, 1193); (130, 333); (828, 1517); (170, 925); (1235, 1322); (1908, 1713); (1000, 0); (1966, 1900); (1935, 1878); (611, 1653); (1635, 735); (662, 1257); (969, 494); (1456, 1208); (1952, 249); (156, 598); (732, 1469); (340, 727); (453, 256); (1785, 943); (1999, 438); (1338, 1477); (1973, 458); (605, 1115); (515, 1547); (1182, 466); (142, 681); (1678, 1392); (1540, 264); (1952, 1757); (1711, 929); (955, 482); (617, 1979); (241, 420); (840, 1450); (499, 1738); (1330, 1929); (1190, 122); (368, 1605); (27, 1276); (1676, 1484); (1101, 841); (187, 101); (1915, 1830); (679, 290); (1199, 490); (1422, 174); (582, 740); (63, 604); (80, 1768); (857, 971); (1466, 1103); (612, 28); (473, 364); (674, 669); (1904, 1889); (608, 1219); (1209, 1060); (312, 1880); (455, 1028); (913, 1296); (1787, 1613); (638, 255); (516, 1264); (1891, 1380); (570, 1254); (374, 1386); (1506, 1645); (1206, 474); (971, 1743); (1915, 865); (1703, 0); (1552, 1472); (203, 389); (1931, 1909); (64, 1201); (1570, 974); (1226, 1871); (357, 1514); (1408, 133); (1770, 704); (51, 1240); (1694, 1206); (1863, 1416); (790, 20); (912, 179); (1034, 415); (967, 313); (195, 651); (151, 185); (470, 565); (523, 777); (1281, 1630); (902, 1946); (1934, 885); (1342, 1096); (980, 1172); (93, 1022); (1418, 1605); (1657, 1754); (548, 543); (324, 1279); (1529, 963); (1613, 1035); (207, 1781); (56, 1374); (933, 987); (503, 1924); (1172, 1048); (99, 1134); (497, 1625); (1394, 1395); (1199, 1956); (11, 1195); (58, 645); (1191, 627); (1458, 744)])

let cnf_gen (n:int) (m:int) : cnf =
  (* generates a random formula with m clauses over n variables *)
  let rec gen_clause m =
    if m = 0 then []
    else let x, y = Random.int (2*n), Random.int (2*n) in
         if x = y || x + y = 2*n-1 then gen_clause m else
           (x,y)::gen_clause (m-1)
  in (n,gen_clause m)

(* Code à compléter *)

let add (g : graph) (i : int) (j : int) =
  (* adds edge (i,j) to graph g *)
  g.(i) <- (j::g.(i));
  g.(j) <- (i::g.(j))

let implication_graph (n, clauses : cnf) : graph =
  assert false (* TODO *)

let transpose (g : graph) : graph =
  assert false (* TODO *)

let topological_sort (g : graph) : int list =
  assert false (* TODO *)

let kosaraju  (g : graph) : int array =
  assert false (* TODO *)

let sat (n, clauses as f: cnf) : bool =
  assert false (* TODO *)
